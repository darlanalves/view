/**
 * View
 * Author: Darlan Alves <darlan@moovia.com>
 * Built on 2013-06-21
 */
!function(a){var b=this,c={}.hasOwnProperty,d=function(){},e=b.jQuery||b.Zepto||b.ender||b.$,f=b._||b.$,g=/^attributes|styles|events|hidden$/,h=/^(\S+)\s*(.*)$/,i=extend({statics:{helpers:{},helper:function(a,b){return this.helpers[a]=b,this},match:function(a,b){return Template.registerProcessor(a,b),this}},tagName:"div",className:!1,template:!1,styles:!1,attributes:!1,el:!1,defaults:!1,rendered:!1,hidden:!1,events:!1,autoRender:!1,initialize:d,render:d,getEl:function(){return this.$el},getDom:function(){return this.el},getBody:function(){return this.el.innerHTML},getId:function(){return this.$id},update:function(a){this.setData(a),this.renderView()},show:function(){return this.$el.show(),this},hide:function(){return this.$el.hide(),this},block:function(){this.$el.addClass("ui-blocked"),this.undelegateEvents()},unblock:function(){this.$el.removeClass("ui-blocked"),this.delegateEvents()},on:function(){this.$el.on.apply(this.$el,arguments)},off:function(){this.$el.off.apply(this.$el,arguments)},appendTo:function(a){this.ensureView(),this.$el.appendTo(a)},prependTo:function(a){this.ensureView(),this.$el.prependTo(a)},insertBefore:function(a){this.ensureView(),a instanceof e||(a=e(a)),a.before(this.$el)},insertAfter:function(){this.ensureView(),el instanceof e||(el=e(el)),el.after(this.$el)},select:function(){return this.$el.select.apply(this.$el,arguments)},before:function(a){return this.$before.push(a),this},after:function(a){return this.$after.push(a),this},setVisible:function(a){a===!1?this.hide():this.show()},constructor:function(a){this.__initialize__!==!1&&(this.$id=f.uniqueId("view"),this.$before=[],this.$after=[],this.createView(),this.doInitialize(a),this.autoRender&&this.renderView())},ensureView:function(){this.rendered||this.renderView()},doInitialize:function(a){a=f.merge({},this.defaults||{},a),f.pick(a,function(b,c){g.test(c)&&(delete a[c],this[c]=b)},this),a.data&&(this.setData(a.data),delete a.data),this.options=a,this.initialize(a)},getOptions:function(){return this.options},createView:function(){var a=document.createElement(this.tagName);this.$el=e(a),this.el=a},renderView:function(){this.rendered=!0,this.applyAttributes(),this.applyStyles(),this.applyClasses(),this.applyTemplate(),this.delegateEvents(),this.runProcessors(this.$before),this.render(),this.runProcessors(this.$after),this.setVisible(!this.hidden)},runProcessors:function(a){var b=this.getData();f.each(a,function(a){a.call(this,b)},this)},destroyView:function(){this.undelegateEvents(),this.$el.remove(),this.el=this.$el=null},applyAttributes:function(){this.attributes!==!1&&this.$el.attr(this.attributes)},applyStyles:function(){this.styles!==!1&&this.$el.css(this.styles)},applyClasses:function(){var a,b,d=this.self.prototype,e=[],g=" ",h="className";for(c.call(d,h)&&e.unshift(d[h]),b=this.superclass;b;)c.call(b,h)&&(a=b[h],a!==!1&&(f.isArray(a)&&(a=a.join(g)),e.unshift(a))),b=b.superclass;this.$el.addClass(e.join(g))},applyTemplate:function(){var a=this.getTemplate(),b=this.getData();this.el.innerHTML=a.render(b,this.self.helpers)},getTemplate:function(a){if(void 0!==a)var b=this[a];else var b=this.template||"";return b instanceof Template||(b=new Template(b),this[a]=b),b},getData:function(){return this.data},setData:function(a){this.data=a},delegateEvents:function(){if(this.events!==!1){var a=".delegate"+this.getId();f.each(events,function(b,c){if("function"!=typeof b&&(b=this[b]),b){var d=h.match(c),e=d[1],f=d[2];e+=a,""===f?this.$el.on(e,b):this.$el.on(e,f,b)}},this)}return this},undelegateEvents:function(){return this.$el.off(".delegate"+this.getId()),this}});a.View=i}("object"==typeof exports&&exports||this);